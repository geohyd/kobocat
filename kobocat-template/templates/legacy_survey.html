{% load i18n %}
{% load static %}

{% with legacy_survey_url="https://ee.kobotoolbox.org/single/XyEzJRoc" %}

<script type="text/javascript">
  (function () {
    window.addEventListener("DOMContentLoaded", function () {
      const popupId = 'legacy-survey-popup';
      const popupEl = document.getElementById(popupId);
      const popupCloseEl = document.getElementById('legacy-survey-popup-close');
      const popupTakeEl = document.getElementById('legacy-survey-popup-take');
      const hiddenClass = 'legacy-survey-popup--hidden';

      function closePopup() {
        popupEl.classList.add(hiddenClass);
        localStorage.setItem(popupId, "seen");
        return false;
      }

      function openPopup() {
        popupEl.classList.remove(hiddenClass);
        return true;
      }

      popupCloseEl.addEventListener("click", closePopup);
      popupTakeEl.addEventListener("click", closePopup);

      if (localStorage.getItem(popupId) !== "seen") {
        openPopup();
      }
    });
  })();
</script>

<style media="screen">
  .legacy-warning {
    padding: 0 20px;
    box-sizing: border-box;
  }

  .legacy-warning .container {
    max-width: 100%;
  }

  .legacy-survey-popup {
    position: fixed;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    background-color: hsla(0, 0%, 0%, 0.25);
    z-index: 9000;
  }

  .legacy-survey-popup,
  .legacy-survey-popup * {
    box-sizing: border-box;
  }

  .legacy-survey-popup__content {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    max-height: 90%;
    max-width: 90%;
    width: 1000px;
    overflow: auto;
    background: hsl(0, 0%, 100%);
    border-left: 5px solid #fe556a;
    padding: 0 50px;
    border-radius: 1px;
    box-shadow: 0 5px 10px 0 hsla(0, 0%, 0%, 0.25);
  }

  .legacy-survey-popup.legacy-survey-popup--hidden {
    display: none;
  }

  .legacy-survey-popup-close {
    position: absolute;
    top: 20px;
    right: 20px;
    background: none;
    border: 0;
    padding: 0;
    margin: 0;
    font-size: 40px;
    line-height: 20px;
  }

  .legacy-survey-popup-close:hover {
    color: hsl(206, 90%, 55%);
  }

  .legacy-survey-popup-close:active {
    transform: translateY(1px);
  }

  .legacy-survey-bar {
    margin-top: -15px;
  }

  .legacy-survey-bar .legacy-survey {
    max-width: calc(984px + 20px);
    padding: 30px 0;
  }

  .legacy-survey,
  .legacy-survey * {
    box-sizing: border-box;
  }

  .legacy-survey__header {
    font-size: 1rem;
    line-height: 1.25;
    font-weight: 700;
    margin: 0;
  }

  .legacy-survey-bar .legacy-survey__header {
    font-size: 15px;
  }

  .legacy-survey-popup .legacy-survey__header {
    font-size: 20px;
    margin-top: 60px;
  }

  .legacy-survey-popup .legacy-survey__header span {
    display: block;
  }

  .legacy-survey__text {
    line-height: 1.25;
  }

  .legacy-survey-bar .legacy-survey__text {
    overflow: hidden;
    font-size: 13px;
    margin: 15px 0 0 0;
  }

  .legacy-survey-popup .legacy-survey__text {
    clear: both;
  }

  .legacy-survey__icon {
    float: left;
    width: auto;
    height: auto;
    margin-bottom: 30px;
  }

  .legacy-survey-bar .legacy-survey__icon {
    width: 50px;
    margin-right: 15px;
  }

  .legacy-survey-popup .legacy-survey__icon {
    width: 60px;
    margin-right: 30px;
  }

  .legacy-survey__button {
    display: inline-block;
    vertical-align: middle;
    position: relative;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    text-transform: uppercase;
    text-decoration: none;
    text-align: center;
    border-radius: 6px;
    color: hsl(0, 0%, 100%) !important;
    background-color: hsl(206, 90%, 55%);
    box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.25);
    height: auto;
    min-height: 40px;
    line-height: 30px;
    padding: 5px 30px;
    margin: 0;
    border: none;
  }

  .legacy-survey__button:hover {
    background-image: url("data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNk4AcAABUAET9MVpIAAAAASUVORK5CYII=");
  }

  .legacy-survey__button:active {
    transform: translateY(1px);
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.25);
  }

  .legacy-survey-bar .legacy-survey__button {
    float: right;
    margin: 25px 0 25px 30px;
  }

  .legacy-survey-popup .legacy-survey__button {
    margin: 50px auto;
    display: block;
    width: 100%;
    max-width: 300px;
  }
</style>

<div id="legacy-survey-popup" class="legacy-survey-popup legacy-survey-popup--hidden">
  <section class="legacy-survey-popup__content">
    <button id="legacy-survey-popup-close" class="legacy-survey-popup-close" type="button" name="button">&times;</button>

    <section class="legacy-survey">
      <h1 class="legacy-survey__header">
        <svg class="legacy-survey__icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 404.92 348">
          <defs>
            <style>
              .cls-a-1 {
                fill: #e9edf0;
              }
              .cls-a-2 {
                fill: #52c5d0;
              }
              .cls-a-3 {
                fill: #414453;
              }
            </style>
          </defs>
          <title>icon</title>
          <circle class="cls-a-1" cx="162.81" cy="185.37" r="156.25"/>
          <path class="cls-a-2" d="M251,76.65l38.05-61.52a5.51,5.51,0,0,1,9.37,5.79c-.09.15-.2.3-.31.44L254.25,78.88A2,2,0,0,1,251,76.65Z"/>
          <path class="cls-a-2" d="M273.86,115.15,381.78,57.06a8.43,8.43,0,1,1,8,14.84,8.67,8.67,0,0,1-.84.39L275.27,118.16a1.66,1.66,0,0,1-1.41-3Z"/>
          <path class="cls-a-2" d="M284.1,153.48l61.57-4.22a5.51,5.51,0,0,1,.75,11,5.64,5.64,0,0,1-.62,0l-61.65-2.74a2,2,0,0,1,0-4Z"/>
          <path class="cls-a-3" d="M70.89,188.59h7a0,0,0,0,1,0,0v46a0,0,0,0,1,0,0h-7a2,2,0,0,1-2-2v-42a2,2,0,0,1,2-2Z" transform="translate(-82.38 50.68) rotate(-24.94)"/>
          <path class="cls-a-3" d="M223.93,107.26l26.25,56.45a35,35,0,0,0-26.25-56.45Z"/>
          <path class="cls-a-3" d="M145,267.44a27,27,0,0,1-.6,16.69l-1.31,3.59a2,2,0,0,0,.07,1.53l2.6,5.6a2,2,0,0,0,2.66,1l39.9-18.55a2,2,0,0,0,1-2.66l-23-49.48-31.54,6.43Z"/>
          <path class="cls-a-3" d="M262.87,202.85,201.76,71.44a2,2,0,0,0-3.06-.72L68.47,174.87a2,2,0,0,0-.56,2.41L96.1,237.89A2,2,0,0,0,98.31,239l36.41-7.44-.74.15.74-.15,31.54-6.43h0l13.24-2.71,1.4,12.26a2.85,2.85,0,1,0,5.66-.64l-1.46-12.76,76.36-15.61A2,2,0,0,0,262.87,202.85Z"/>
        </svg>
        <span>{% trans "The legacy interface will soon disappear." %}</span>
        <span>{% trans "Please let us know how and why you are still using it." %}</span>
      </h1>

      <p class="legacy-survey__text"><strong>{% trans "We are planning to remove some or all of it’s the components from this legacy user interface for viewing project data" %}</strong> {% trans "(also known as kobocat). We introduced the new user interface in 2016 which eventually included access to all features that were previously only available in the legacy interface (and many more features). Maintaining the legacy interface functionality and security involves a lot of work and costs for our donors. Today, only a very small number of users still access the legacy user interface — including you." %}</p>

      <p class="legacy-survey__text">{% trans "We announced a while ago on this page that deploying projects on the legacy interface was highly discouraged and that its user interface will be removed “shortly”. We care deeply about our users, so before we disable the legacy interface completely, we ask you to let us know why you are still using the old user interface." %} <strong>{% trans "This should not take more than a minute." %}</strong></p>

      <a 
        id="legacy-survey-popup-take" 
        class="legacy-survey__button" 
        href="{{ legacy_survey_url }}"
        target="_blank"
      >{% trans "Take survey now" %}</a>
    </section>
  </section>
</div>

<div class="legacy-survey-bar">
  <section class="legacy-survey container">
    <a class="legacy-survey__button" href="{{ legacy_survey_url }}" target="_blank">{% trans "Take survey now" %}</a>

    <h1 class="legacy-survey__header">
      <svg class="legacy-survey__icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 404.92 348">
        <defs>
          <style>
            .cls-b-1 {
              fill: #ffffff;
            }
            .cls-b-2 {
              fill: #52c5d0;
            }
            .cls-b-3 {
              fill: #414453;
            }
          </style>
        </defs>
        <title>icon</title>
        <circle class="cls-b-1" cx="162.81" cy="185.37" r="156.25"/>
        <path class="cls-b-2" d="M251,76.65l38.05-61.52a5.51,5.51,0,0,1,9.37,5.79c-.09.15-.2.3-.31.44L254.25,78.88A2,2,0,0,1,251,76.65Z"/>
        <path class="cls-b-2" d="M273.86,115.15,381.78,57.06a8.43,8.43,0,1,1,8,14.84,8.67,8.67,0,0,1-.84.39L275.27,118.16a1.66,1.66,0,0,1-1.41-3Z"/>
        <path class="cls-b-2" d="M284.1,153.48l61.57-4.22a5.51,5.51,0,0,1,.75,11,5.64,5.64,0,0,1-.62,0l-61.65-2.74a2,2,0,0,1,0-4Z"/>
        <path class="cls-b-3" d="M70.89,188.59h7a0,0,0,0,1,0,0v46a0,0,0,0,1,0,0h-7a2,2,0,0,1-2-2v-42a2,2,0,0,1,2-2Z" transform="translate(-82.38 50.68) rotate(-24.94)"/>
        <path class="cls-b-3" d="M223.93,107.26l26.25,56.45a35,35,0,0,0-26.25-56.45Z"/>
        <path class="cls-b-3" d="M145,267.44a27,27,0,0,1-.6,16.69l-1.31,3.59a2,2,0,0,0,.07,1.53l2.6,5.6a2,2,0,0,0,2.66,1l39.9-18.55a2,2,0,0,0,1-2.66l-23-49.48-31.54,6.43Z"/>
        <path class="cls-b-3" d="M262.87,202.85,201.76,71.44a2,2,0,0,0-3.06-.72L68.47,174.87a2,2,0,0,0-.56,2.41L96.1,237.89A2,2,0,0,0,98.31,239l36.41-7.44-.74.15.74-.15,31.54-6.43h0l13.24-2.71,1.4,12.26a2.85,2.85,0,1,0,5.66-.64l-1.46-12.76,76.36-15.61A2,2,0,0,0,262.87,202.85Z"/>
      </svg>
      <span>{% trans "The legacy interface will soon disappear." %}</span>
      <span>{% trans "Please let us know how and why you are still using it." %}</span>
    </h1>

    <p class="legacy-survey__text">{% trans "We are planning to remove some or all of it’s the components from this legacy user interface for viewing project data (also known as kobocat). We care deeply about our users, so before we disable the legacy interface completely, we ask you to let us know why you are still using the old user interface." %} <strong>{% trans "This should not take more than a minute." %}</strong></p>
  </section>
</div>

{% endwith %}